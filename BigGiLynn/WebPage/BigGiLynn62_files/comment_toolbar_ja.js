(function(){var g=false;var h="http://static.fc2.com/js/blog/view/comment/";var m="",target=null,dialog=null,config=null,iframe=null,lang=null,JSON={},cache="",src="";var o="display: none; position: absolute; top: 27px; left: 0;z-index:100000;";var p="border: 0 none; height: 200px;";var q="display: none; position: absolute; top: 27px; left: 0;z-index:100000;";var r="border: 0 none; height: 391px;width: 267px;";var t=(function(){var a,v=3,div=document.createElement('div');while(div.innerHTML='<!--[if gt IE '+(++v)+']><i></i><![endif]-->',div.getElementsByTagName('i')[0]);return v>4?v:a}());var u=function(){this.Palette={container:(o?o:"display: none; position: absolute; top: 0; left: 0;"),table:(p?p:"border: 0 none;")};this.Icon={container:(q?q:"display: none; position: absolute; top: 0; left: 0;"),table:(r?r:"border: 0 none;")}};u.prototype.css=function(a){if(!a)return;switch(a){case"palette":return this.Palette;break;case"icon":return this.Icon;break;default:break}};var w=function(){this.menu={"palette":null,"icon":null};var a=new Date()-0;var b=document.getElementById("tools_container");for(var i in this.menu){var c=config.css(i);var d="<iframe src='";d+=h+"dialog/"+i+".html";d+="?u="+encodeURIComponent(location.href);d+="&lang="+encodeURIComponent(m);d+="' frameborder='0' style='"+c.table+"'></iframe\>";var e=document.createElement("div");e.style.cssText=c.container;e.setAttribute("id","FC2_comment_"+i);e.innerHTML=d;b.appendChild(e);this.menu[i]=e}};w.prototype={show:function(a){if(!a||"string"!=typeof a)return;this.menu[a].style.display="block"},hide:function(a){if(!a||"string"!=typeof a)return;this.menu[a].style.display="none"},setPosition:function(a){if(!a)return;var b=B("#tools_container")}};var x=function(c){try{return c.replace(/\\u([a-fA-F0-9]{4})/g,function(a,b){return String.fromCharCode(parseInt(b,16))})}catch(ex){return false}};var y=function(a){for(var i in dialog.menu){dialog.hide(i)}dialog.show(a)};var z=function(a){var b="";var c="";var d="";var e="";var f="";if((/^icon:/).test(a)){a=a.split(":");b=a[0].toUpperCase()+"_TAG";f=":"+a[1]}else{if((/^color:/).test(a)){a=a.split(":");b=a[0].toUpperCase()+"_TAG";f=":"+a[1]}else{b=a.toUpperCase()+"_TAG"}d="[/"+lang[b][m]+"]";e=lang[b+"_TEXT"][m]}c="["+lang[b][m]+f+"]";A(c,d,e)};var A=function(a,b,c){if(!target)return;target.focus();if(document.selection!=null){var d=document.selection.createRange().text;if(d){document.selection.createRange().text=a+d+b}else{document.selection.createRange().text=a+c+b}}else if(target.selectionStart||target.selectionStart=='0'){var s=target.selectionStart;var e=target.selectionEnd;var f=target.value.substring(s,e);if(f){target.value=target.value.substring(0,s)+a+f+b+target.value.substring(e,target.value.length)}else{target.value=target.value.substring(0,s)+a+c+b+target.value.substring(e,target.value.length)}target.focus()}else{target.value+=a+c+b}for(var i in dialog.menu){dialog.hide(i)}};var B=function(a){if(!a||"string"!=typeof a)return;var b=document.getElementById(a);if(!b)return;var c=b.getBoundingClientRect();return{left:c.left-(document.body.scrollLeft||document.documentElement.scrollLeft),top:c.top-(document.body.scrollTop||document.documentElement.scrollTop)}};var C=function(a,b){if(!b)return;try{dialog.menu[b].style.height=(a)?a+"px":""}catch(ex){}};var D=function(){var a=document.documentElement.scrollTop||window.scrollY;window.location=location.href.split("#")[0]+"#fc2CommentToolbar";window.scroll(0,a)};var E=function(){document.write("<div id=\"tools_container\" style=\"position:relative;width:267px;display: inline-block;\">");document.write("<a href=\"javascript:;\" name=\"fc2CommentToolbar\"></a>");document.write("<iframe id=\"tools_dialog\" frameborder=\"0\" sandbox=\"allow-scripts allow-same-origin\" style=\"height: 30px;border:0 none;overflow: hidden;width: 267px;\"></iframe>");document.write("</div>")};var F=function(){var b=setTimeout(function(){target=(function(a){if(a){return(a.comment)?a.comment:null}})(document.getElementById("comment_form")||document.comment_form);clearTimeout(b)},100)};var G=function(){var a=document.createElement("link");a.setAttribute("type","text/css");a.setAttribute("href",h+"index.css");var b=document.body.parentNode.childNodes[0];b.appendChild(a)};var H=function(){var a=document.getElementsByTagName("script");for(var i=0;i<a.length;i++){var b=a[i].getAttribute("src");if(!b)continue;var c=b.match(new RegExp(h+"comment_toolbar_([a-z]{2})?.min.js"));if(!c)continue;return c[1]?c[1]:"ja"}};function f(n){return n<10?'0'+n:n};if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()}};var I=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(b){escapable.lastIndex=0;return escapable.test(b)?'"'+b.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function str(a,b){var i,k,v,length,mind=gap,partial,value=b[a];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(a)};if(typeof rep==='function'){value=rep.call(b,a,value)};switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null'};gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null'};v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v};if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==='string'){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}};v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v}};if(typeof JSON.stringify!=='function'){JSON.stringify=function(a,b,c){var i;gap='';indent='';if(typeof c==='number'){for(i=0;i<c;i+=1){indent+=' '}}else if(typeof c==='string'){indent=c};rep=b;if(b&&typeof b!=='function'&&(typeof b!=='object'||typeof b.length!=='number')){throw new Error('JSON.stringify');};return str('',{'':a})}};if(typeof JSON.parse!=='function'){JSON.parse=function(c,d){var j;function walk(a,b){var k,v,value=a[b];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}};return d.call(a,b,value)};c=String(c);I.lastIndex=0;if(I.test(c)){c=c.replace(I,function(a){return'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})};if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+c+')');return typeof d==='function'?walk({'':j},''):j};throw new SyntaxError('JSON.parse');}};var J=function(e){try{var a=JSON.parse(e.data);for(var i in a){for(var l in a[i]){a[i][l]=x(a[i][l])}};var b=a.p;switch(a.m){case"instag":z(b.start,b.end,b.str);break;case"tglmenu":y(b.target);break;case"seth":C(b.height,b.target);break;default:break}}catch(ex){}};var K=function(){try{var a=location.href.split("#");if(1>=a.length)return;var b=decodeURIComponent(a[1]);if(!b.match(/^([0-9]*?)\&/))return;var c=(b.match(/^([0-9]*?)\&/))?b.match(/^([0-9]*?)\&/)[1]:false;if(!c||cache==c)return;cache=c;var d=b.replace(/^(?:[0-9]*?\&)/,"");d=JSON.parse(d);for(var i in d){for(var l in d[i]){d[i][l]=x(d[i][l])}}J({data:d});return true}catch(ex){return false}};var L=function(a,b,c){c=c||window;if(t<9){if(a==="load"){c.onreadystatechange=b}else{c.attachEvent("on"+a,b)}}else{c.addEventListener(a,b,false)}};var M=function(){m=H();E();F();G();config=new u();dialog=new w();iframe=document.getElementById("tools_dialog");src=h+"comment_toolbar.html";src+="?u="+encodeURIComponent(location.href);src+="&lang="+encodeURIComponent(m);iframe.setAttribute("src",src);var b=function(){if("undefined"==typeof FC2Blog)return;lang=FC2Blog.Language.CommentTool};var c=document.createElement("script");L("load",b,c);c.setAttribute("src",h+"comment_toolbar.lang.js");document.getElementsByTagName("head")[0].appendChild(c);if(g||!window.postMessage){var d=setInterval(function(){var a=K();if(false===a){clearInterval(d)}else if(true===a){D()}},100)}else{L("message",J)}};M()})();